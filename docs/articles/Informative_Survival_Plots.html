<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Survival plots have never been so informative • survminer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Survival plots have never been so informative">
<meta property="og:description" content="survminer">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survminer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../survminer_cheatsheet.pdf">Cheatseet</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kassambara/survminer">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Survival plots have never been so informative</h1>
                        <h4 class="author">Marcin Kosinski</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kassambara/survminer/blob/master/vignettes/Informative_Survival_Plots.Rmd"><code>vignettes/Informative_Survival_Plots.Rmd</code></a></small>
      <div class="hidden name"><code>Informative_Survival_Plots.Rmd</code></div>

    </div>

    
    
<p><img src="survminer_orly.png" class="fit image"></p>
<blockquote>
<p>This vignette covers changes between versions 0.1.0 and 0.2.0.</p>
</blockquote>
<div id="motivation" class="section level1">
<h1 class="hasAnchor">
<a href="#motivation" class="anchor"></a>Motivation</h1>
<p><a href="https://www.r-bloggers.com/2015/12/ggplot-2-0-0/">Hadley Wickham’s ggplot2 version 2.0 revolution</a>, at the end of 2015, triggered many crashes in dependent R packages, that finally led to deletions of few packages from <a href="https://cran.r-project.org/">The Comprehensive R Archive Network</a>. It occured that <code>survMisc</code> package was removed from CRAN on 27th of January 2016 and R world remained helpless in the struggle with the elegant visualizations of survival analysis. Then a new tool - <a href="https://cran.r-project.org/package=survminer">survminer</a> package, created by <a href="https://github.com/kassambara">Alboukadel Kassambara</a> - appeared on the R survival scene to fill the gap in visualizing the Kaplan-Meier estimates of survival curves in elegant grammar of graphics like way. This blog presents main features of core <code><a href="../reference/ggsurvplot.html">ggsurvplot()</a></code> function from survminer package, <em>which creates the most informative, elegant and flexible survival plots that I have seen!</em></p>
<p>During the development of <a href="http://rtcga.github.io/RTCGA/">RTCGA</a> package (about which I wrote <a href="http://r-addict.com/2016/05/04/RTCGA-Quick-Guide.html">here</a>) we encountered a need to provide the simplest possible interface to estimates of survival curves for biotechnologists and <a href="http://www.sthda.com/english/wiki/survminer-r-package-survival-data-analysis-and-visualization">the discovery of <code><a href="../reference/ggsurvplot.html">ggsurvplot()</a></code></a> was a bull’s-eye! <a href="https://github.com/tidyverse/ggplot2/issues/1080">Many have tried</a> to provide a package or function for ggplot2-like plots that would present the basic tool of survival analysis: Kaplan-Meier estimates of survival curves, but none of earlier attempts have provided such a rich structure of features and flexibility as survminer. On basis of estimates of survival curves one can infere on differences in survival times between compared groups, so survival plots are very useful and can be seen in almost every publication in the field of survival analysis and time to event models.</p>
</div>
<div id="example" class="section level1">
<h1 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h1>
<p>After regular installation</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">'survminer'</span>)
<span class="kw pkg">BiocManager</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"RTCGA.clinical"</span>) <span class="co"># data for examples</span></pre></body></html></div>
<p>we can create simple estimates of survival curves just after we put <code>survfit</code> (survival package) object into <code><a href="../reference/ggsurvplot.html">ggsurvplot()</a></code> function. Let’s have a look at differences in survival times between patients suffering from Ovarian Cancer (<em>Ovarian serous cystadenocarcinoma</em>) and patients suffering from Breast Cancer (<em>Breast invasive carcinoma</em>), where data were collected by <a href="https://www.cancer.gov/about-nci/organization/ccg/research/structural-genomics/tcga">The Cancer Genome Atlas Project</a>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">survminer</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">RTCGA.clinical</span>)
<span class="fu">survivalTCGA</span>(<span class="no">BRCA.clinical</span>, <span class="no">OV.clinical</span>,
             <span class="kw">extract.cols</span> <span class="kw">=</span> <span class="st">"admin.disease_code"</span>) <span class="kw">-&gt;</span> <span class="no">BRCAOV.survInfo</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">survival</span>)
<span class="no">fit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span>(<span class="no">times</span>, <span class="no">patient.vital_status</span>) ~ <span class="no">admin.disease_code</span>,
               <span class="kw">data</span> <span class="kw">=</span> <span class="no">BRCAOV.survInfo</span>)
<span class="co"># Visualize with survminer</span>
<span class="fu"><a href="../reference/ggsurvplot.html">ggsurvplot</a></span>(<span class="no">fit</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">BRCAOV.survInfo</span>, <span class="kw">risk.table</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="Informative_Survival_Plots_files/figure-html/unnamed-chunk-4-1.png" width="960"></p>
<p>This simple plot presents, in an elegant way, estimates of survival probability depending on days from cancer diagnostics grouped by cancer types and an informative risk set table, which shows the number of patients that were under observation in the specific period of time. Survival analysis is a specific field of data analysis because of the censored time to event data, so risk set size is a must in visual inference.</p>
<p>After few improvements (#1, #2, #3, #4, #7, #8, #12, #28), made by Alboukadel in version 0.2.0, one can create a powerful, informative survival plot with such specification of parameters</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/ggsurvplot.html">ggsurvplot</a></span>(
   <span class="no">fit</span>,                     <span class="co"># survfit object with calculated statistics.</span>
   <span class="kw">data</span> <span class="kw">=</span> <span class="no">BRCAOV.survInfo</span>,  <span class="co"># data used to fit survival curves. </span>
   <span class="kw">risk.table</span> <span class="kw">=</span> <span class="fl">TRUE</span>,       <span class="co"># show risk table.</span>
   <span class="kw">pval</span> <span class="kw">=</span> <span class="fl">TRUE</span>,             <span class="co"># show p-value of log-rank test.</span>
   <span class="kw">conf.int</span> <span class="kw">=</span> <span class="fl">TRUE</span>,         <span class="co"># show confidence intervals for </span>
                            <span class="co"># point estimaes of survival curves.</span>
   <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">2000</span>),        <span class="co"># present narrower X axis, but not affect</span>
                            <span class="co"># survival estimates.</span>
   <span class="kw">break.time.by</span> <span class="kw">=</span> <span class="fl">500</span>,     <span class="co"># break X axis in time intervals by 500.</span>
   <span class="kw">ggtheme</span> <span class="kw">=</span> <span class="fu">theme_minimal</span>(), <span class="co"># customize plot and risk table with a theme.</span>
 <span class="kw">risk.table.y.text.col</span> <span class="kw">=</span> <span class="no">T</span>, <span class="co"># colour risk table text annotations.</span>
  <span class="kw">risk.table.y.text</span> <span class="kw">=</span> <span class="fl">FALSE</span> <span class="co"># show bars instead of names in text annotations</span>
                            <span class="co"># in legend of risk table</span>
)</pre></body></html></div>
<p><img src="Informative_Survival_Plots_files/figure-html/unnamed-chunk-5-1.png" width="960"></p>
<p>Each parameter is described in the correspoding comment, but I would like to emphasize the <code>xlim</code> parameter which controls limits of the X axis but does not affect the survival curves, that are taking into account all possible times. Another brilliant parameter is <code>break.time.by</code> that affects survival plots and the risk set table - this would not be so easy to create it by yourself. Also a <code>ggtheme</code> parameter is beneficial for simple plot customization. Finally, <code>risk.table.y.text</code> and <code>risk.table.y.text.col</code> (for which I have provided a user requests) are useful parameters that change text (often too long and redundand) from risk table legend into narrow, coloured bar. This saves a lot of space in the final plot.</p>
</div>
<div id="comparisons" class="section level1">
<h1 class="hasAnchor">
<a href="#comparisons" class="anchor"></a>Comparisons</h1>
<p>Even though <a href="https://cran.r-project.org/package=survMisc"><code>survMisc</code></a> have returned on CRAN, I’ve appreciated survminer so much that I would not look anymore for other solutions. Check why: at the end I present survival curves that can be obtained with the usage of <code>base</code> package and <code>survMisc</code> package.</p>
<div id="base-package" class="section level3">
<h3 class="hasAnchor">
<a href="#base-package" class="anchor"></a>base package</h3>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">fit</span>) <span class="co"># base</span></pre></body></html></div>
<p><img src="Informative_Survival_Plots_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
<p>It looks pretty… base…</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">fit</span>, <span class="kw">col</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"orange"</span>,<span class="st">"purple"</span>), <span class="kw">lty</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">2</span>), <span class="kw">lwd</span><span class="kw">=</span><span class="fl">3</span>, <span class="co"># base with some customization</span>
     <span class="kw">conf.int</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">xmax</span> <span class="kw">=</span> <span class="fl">2000</span>)
<span class="co"># add a legend</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="fl">100</span>, <span class="fl">.2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Ovarian Cancer"</span>, <span class="st">"Breast Cancer"</span>),
       <span class="kw">lty</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">2</span>), <span class="kw">col</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"orange"</span>,<span class="st">"purple"</span>))</pre></body></html></div>
<p><img src="Informative_Survival_Plots_files/figure-html/unnamed-chunk-7-1.png" width="960"></p>
<p>I haven’t seen examples with risk table and adding legend isn’t so quick as in survminer. Moreover, there are no minor axis breaks lines.</p>
</div>
<div id="survmisc-package" class="section level3">
<h3 class="hasAnchor">
<a href="#survmisc-package" class="anchor"></a>survMisc package</h3>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># install.packages('survMisc')</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">survMisc</span>)
<span class="kw pkg">survMisc</span><span class="kw ns">:::</span><span class="fu"><a href="https://rdrr.io/pkg/survMisc/man/autoplotTen.html">autoplot.survfit</a></span>(<span class="no">fit</span>) <span class="co"># no customization</span></pre></body></html></div>
<p><em>Why colours are not asigned to any group? Where is the legend? Why there is so much white space to the right?</em> (Those were questions for the version of survMisc where this was an issue.) Where is OX axis?</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="kw pkg">survMisc</span><span class="kw ns">:::</span><span class="fu"><a href="https://rdrr.io/pkg/survMisc/man/autoplotTen.html">autoplot.survfit</a></span>( <span class="co"># with some hard customization</span>
   <span class="no">fit</span>,
   <span class="kw">type</span> <span class="kw">=</span> <span class="st">"fill"</span>,
   <span class="kw">pVal</span><span class="kw">=</span><span class="fl">TRUE</span>
) <span class="kw">-&gt;</span> <span class="no">fit.survMisc</span>
<span class="no">fit.survMisc</span>$<span class="no">table</span> <span class="kw">&lt;-</span> <span class="no">fit.survMisc</span>$<span class="no">table</span> +
   <span class="fu">theme_minimal</span>() + <span class="co"># theme(legend.position = "top")</span>
   <span class="fu">coord_cartesian</span>(<span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">2000</span>))
<span class="no">fit.survMisc</span>$<span class="no">plot</span> <span class="kw">&lt;-</span> <span class="no">fit.survMisc</span>$<span class="no">plot</span> +
   <span class="fu">theme_minimal</span>() +
   <span class="fu">coord_cartesian</span>(<span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">2000</span>))
<span class="kw pkg">survMisc</span><span class="kw ns">:::</span><span class="fu"><a href="https://rdrr.io/pkg/survMisc/man/print.html">print.tableAndPlot</a></span>(<span class="no">fit.survMisc</span>)</pre></body></html></div>
<p>Where is risk table? Why I can’t pass <code>break.by.time</code> to have informative minor X axis breaks? Why the plot gets narrower when the legend in risk table gets wider and why I can’t do anything to workaround this?</p>
<blockquote>
<p>Never mind -&gt; <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages('survminer')</a></code></p>
</blockquote>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alboukadel Kassambara, Marcin Kosinski, Przemyslaw Biecek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
