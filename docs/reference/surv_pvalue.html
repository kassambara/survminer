<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute P-value Comparing Survival Curves — surv_pvalue • survminer</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute P-value Comparing Survival Curves — surv_pvalue" />
<meta property="og:description" content="Compute p-value from survfit objects or parse it when provided by
 the user. Survival curves are compared using the log-rank test (default).
 Other methods can be specified using the argument method." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">survminer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../survminer_cheatsheet.pdf">Cheatseet</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kassambara/survminer">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute P-value Comparing Survival Curves</h1>
    <small class="dont-index">Source: <a href='https://github.com/kassambara/survminer/blob/master/R/surv_pvalue.R'><code>R/surv_pvalue.R</code></a></small>
    <div class="hidden name"><code>surv_pvalue.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute p-value from survfit objects or parse it when provided by
 the user. Survival curves are compared using the log-rank test (default).
 Other methods can be specified using the argument <code>method</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>surv_pvalue</span>(
  <span class='no'>fit</span>,
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"survdiff"</span>,
  <span class='kw'>test.for.trend</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>combine</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fit</th>
      <td><p>A survfit object. Can be also a list of survfit objects.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data frame used to fit survival curves. Can be also a list of
data.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>method to compute survival curves. Default is "survdiff" (or
"log-rank"). Allowed values are one of:</p><ul>
<li><p>"survdiff",
log-rank;</p></li>
<li><p>"1": log-rank, LR; --&gt; Regular log-rank test, sensitive to
detect late differences.</p></li>
<li><p>"n": Gehan-Breslow (generalized Wilcoxon),
GB; --&gt; detect early differences.</p></li>
<li><p>"sqrtN": Tarone-Ware, TW; --&gt; detect
early differences.</p></li>
<li><p>"S1": Peto-Peto's modified survival estimate, PP;
--&gt; more robust than Tharone-Whare or Gehan-Breslow, detect early
differences</p></li>
<li><p>"S2": modified Peto-Peto (by Andersen), mPP</p></li>
<li><p>"FH_p=1_q=1": Fleming-Harrington(p=1, q=1),  FH</p></li>
</ul><p>To specify method, one can
use either the weights (e.g.: "1", "n", "sqrtN", ...), or the full name
("log-rank", "gehan-breslow", "Peto-Peto", ...), or the acronyme LR, GB,
.... Case insensitive partial match is allowed.<br /><br /> To learn more about
the mathematical background behind the different log-rank weights, read the
following blog post on R-Addict:
<a href='http://r-addict.com/2017/02/09/Fancy-Survival-Plots.html'>Comparing
(Fancy) Survival Curves with Weighted Log-rank Tests</a></p></td>
    </tr>
    <tr>
      <th>test.for.trend</th>
      <td><p>logical value. Default is FALSE. If TRUE, returns the
test for trend p-values. Tests for trend are designed to detect ordered
differences in survival curves. That is, for at least one group. The test
for trend can be only performed when the number of groups is &gt; 2.</p></td>
    </tr>
    <tr>
      <th>combine</th>
      <td><p>logical value. Used only when fit is a list of survfit objects.
If TRUE, combine the results for multiple fits.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments including pval, pval.coord, pval.method.coord.
These are only used internally to specify custom pvalue, pvalue and pvalue
method coordinates on the survival plot. Normally, users don't need these
arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Return a data frame with the columns (pval, method, pval.txt and
 variable). If additional arguments (pval, pval.coord, pval.method.coord,
 get_coord) are specified, then extra columns (pval.x, pval.y, method.x and
 method.y) are returned.</p><ul>
<li><p>pval: pvalue</p></li>
<li><p>method: method
 used to compute pvalues</p></li>
<li><p>pval.txt: formatted text ready to use for
 annotating plots</p></li>
<li><p>pval.x, pval.y: x &amp; y coordinates of the pvalue for
 annotating the plot</p></li>
<li><p>method.x, method.y: x &amp; y coordinates of pvalue
 method</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>survival</span>)

<span class='co'># Different survfits</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::::::::::::::::::</span>
<span class='no'>fit.null</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='surv_fit.html'>surv_fit</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='fl'>1</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>colon</span>)

<span class='no'>fit1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='surv_fit.html'>surv_fit</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>sex</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>colon</span>)

<span class='no'>fit2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='surv_fit.html'>surv_fit</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>adhere</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>colon</span>)

<span class='no'>fit.list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>sex</span> <span class='kw'>=</span> <span class='no'>fit1</span>, <span class='kw'>adhere</span> <span class='kw'>=</span> <span class='no'>fit2</span>)

<span class='co'># Extract the median survival</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::::::::::::::::::</span>
<span class='fu'>surv_pvalue</span>(<span class='no'>fit.null</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: There are no survival curves to be compared. </span>
#&gt; <span class='warning'> This is a null model.</span></div><div class='output co'>#&gt;   variable pval method pval.txt
#&gt; 1            NA                </div><div class='input'>
<span class='fu'>surv_pvalue</span>(<span class='no'>fit2</span>, <span class='no'>colon</span>)</div><div class='output co'>#&gt;   variable         pval   method    pval.txt
#&gt; 1   adhere 0.0002670768 Log-rank p = 0.00027</div><div class='input'>
<span class='fu'>surv_pvalue</span>(<span class='no'>fit.list</span>)</div><div class='output co'>#&gt; $sex
#&gt;   variable      pval   method pval.txt
#&gt; 1      sex 0.6107936 Log-rank p = 0.61
#&gt; 
#&gt; $adhere
#&gt;   variable         pval   method    pval.txt
#&gt; 1   adhere 0.0002670768 Log-rank p = 0.00027
#&gt; </div><div class='input'>
<span class='fu'>surv_pvalue</span>(<span class='no'>fit.list</span>, <span class='kw'>combine</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;       id variable         pval   method    pval.txt
#&gt; 1    sex      sex 0.6107936361 Log-rank    p = 0.61
#&gt; 2 adhere   adhere 0.0002670768 Log-rank p = 0.00027</div><div class='input'>
<span class='co'># Grouped survfit</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::::::::::::::::::</span>
<span class='no'>fit.list2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='surv_fit.html'>surv_fit</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>sex</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>colon</span>,
                     <span class='kw'>group.by</span> <span class='kw'>=</span> <span class='st'>"rx"</span>)

<span class='fu'>surv_pvalue</span>(<span class='no'>fit.list2</span>)</div><div class='output co'>#&gt; $`rx.Obs::sex`
#&gt;   variable      pval   method pval.txt
#&gt; 1      sex 0.5337304 Log-rank p = 0.53
#&gt; 
#&gt; $`rx.Lev::sex`
#&gt;   variable      pval   method pval.txt
#&gt; 1      sex 0.2928911 Log-rank p = 0.29
#&gt; 
#&gt; $`rx.Lev+5FU::sex`
#&gt;   variable         pval   method    pval.txt
#&gt; 1      sex 0.0005623961 Log-rank p = 0.00056
#&gt; </div><div class='input'>
<span class='co'># Get coordinate for annotion of the survival plots</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::::::::::::::::::</span>
<span class='fu'>surv_pvalue</span>(<span class='no'>fit.list2</span>, <span class='kw'>combine</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>get_coord</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;                id variable         pval   method    pval.txt pval.x pval.y
#&gt; 1     rx.Obs::sex      sex 0.5337303974 Log-rank    p = 0.53  64.28    0.2
#&gt; 2     rx.Lev::sex      sex 0.2928911335 Log-rank    p = 0.29  66.58    0.2
#&gt; 3 rx.Lev+5FU::sex      sex 0.0005623961 Log-rank p = 0.00056  66.18    0.2
#&gt;   method.x method.y
#&gt; 1    64.28      0.3
#&gt; 2    66.58      0.3
#&gt; 3    66.18      0.3</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alboukadel Kassambara, Marcin Kosinski, Przemyslaw Biecek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


